

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3. Design Details &mdash; CDEPS master documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="2. Input Streams" href="streams.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> CDEPS
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="streams.html">2. Input Streams</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">3. Design Details</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#data-model-performance">3.1. Data Model Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#io-through-data-models">3.2. IO Through Data Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#io-through-data-models-in-cime-ccs">3.3. IO Through Data Models In CIME-CCS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#restart-files">3.4. Restart Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stream-modules">3.5. Stream Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stream-datatypes">3.6. Stream Datatypes</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CDEPS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>3. Design Details</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/design_details.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="design-details">
<span id="id1"></span><h1>3. Design Details<a class="headerlink" href="#design-details" title="Permalink to this headline">¶</a></h1>
<div class="section" id="data-model-performance">
<h2>3.1. Data Model Performance<a class="headerlink" href="#data-model-performance" title="Permalink to this headline">¶</a></h2>
<p>There are two primary costs associated with CDEPS share code: reading data and spatially mapping data.
Time interpolation is relatively cheap in the current implementation.
As much as possible, redundant operations are minimized.
The upper and lower bound mapped input data is saved between time steps to reduce mapping costs in cases where data is time interpolated more often than new data is read.
If the input data timestep is relatively small (for example, hourly data as opposed to daily or monthly data) the cost of reading input data can be quite large.
Also, there can be significant variation in cost of the data model over the coarse of the run, for instance, when new inputdata must be read and interpolated, although it’s relatively predictable.
The present implementation doesn’t support changing the order of operations, for instance, time interpolating the data before spatial mapping.
Because the present computations are always linear, changing the order of operations will not fundamentally change the results.
The present order of operations generally minimizes the mapping cost for typical data model use cases.</p>
</div>
<div class="section" id="io-through-data-models">
<h2>3.2. IO Through Data Models<a class="headerlink" href="#io-through-data-models" title="Permalink to this headline">¶</a></h2>
<p>At the present time, data models can only read netcdf data, and IO is handled through the PIO library using either netcdf or pnetcdf.
PIO can read the data either serially or in parallel in chunks that are approximately the global field size divided by the number of IO tasks.
If pnetcdf is used through PIO, then the pnetcdf library must be included during the build of the model.</p>
</div>
<div class="section" id="io-through-data-models-in-cime-ccs">
<h2>3.3. IO Through Data Models In CIME-CCS<a class="headerlink" href="#io-through-data-models-in-cime-ccs" title="Permalink to this headline">¶</a></h2>
<p>If CDEPS is used in CIME, the pnetcdf path and option is hardwired
into the <code class="docutils literal notranslate"><span class="pre">Macros.make</span></code> file for the specific machine.  To turn on
<code class="docutils literal notranslate"><span class="pre">pnetcdf</span></code> in the build, make sure the <code class="docutils literal notranslate"><span class="pre">Macros.make</span></code> variables
<code class="docutils literal notranslate"><span class="pre">PNETCDF_PATH</span></code>, <code class="docutils literal notranslate"><span class="pre">INC_PNETCDF</span></code>, and <code class="docutils literal notranslate"><span class="pre">LIB_PNETCDF</span></code> are set and
that the PIO <code class="docutils literal notranslate"><span class="pre">CONFIG_ARGS</span></code> sets the <code class="docutils literal notranslate"><span class="pre">PNETCDF_PATH</span></code> argument.
Beyond just the option of selecting IO with PIO, several namelist variables are available to help optimize PIO IO performance.
Those are <strong>TODO</strong> - list these.
The total mpi tasks that can be used for IO is limited to the total number of tasks used by the data model.
Often though, using fewer IO tasks results in improved performance.
In general, [io_root + (num_iotasks-1)*io_stride + 1] has to be less than the total number of data model tasks.
In practice, PIO seems to perform optimally somewhere between the extremes of 1 task and all tasks, and is highly machine and problem dependent.</p>
</div>
<div class="section" id="restart-files">
<h2>3.4. Restart Files<a class="headerlink" href="#restart-files" title="Permalink to this headline">¶</a></h2>
<p>Restart files are generated automatically by the data models based on an attribute flag received in the NUOPC cap.
The restart files must meet the CIME-CCS naming convention and an <code class="docutils literal notranslate"><span class="pre">rpointer</span></code> file is generated at the same time.
An <code class="docutils literal notranslate"><span class="pre">rpointer</span></code> file is a <em>restart pointer</em> file which contains the name of the most recently created restart file.
Normally, if restart files are read, the restart filenames are specified in the <code class="docutils literal notranslate"><span class="pre">rpointer</span></code> file.
Optionally though, there are namelist variables such as <code class="docutils literal notranslate"><span class="pre">restfilm</span></code> to specify the restart filenames via namelist. If those namelist variables are set, the <code class="docutils literal notranslate"><span class="pre">rpointer</span></code> file will be ignored.</p>
<p>In most cases, no restart file is required for the data models to restart exactly.
This is because there is no memory between timesteps in many of the data model science modes.
If a restart file is required, it will be written automatically and then must be used to continue the previous run.</p>
<p>There are separate stream restart files that only exist for
performance reasons.  A stream restart file contains information about
the time axis of the input streams.  This information helps reduce the
startup costs associated with reading the input dataset time axis
information.  If a stream restart file is missing, the code will
restart without it but may need to reread data from the input data
files that would have been stored in the stream restart file.  This
will take extra time but will not impact the results.</p>
</div>
<div class="section" id="stream-modules">
<span id="data-structures"></span><h2>3.5. Stream Modules<a class="headerlink" href="#stream-modules" title="Permalink to this headline">¶</a></h2>
<p>The CDEPS stream code contains four modules:</p>
<dl class="docutils">
<dt><strong>dshr_strdata_mod.F90</strong></dt>
<dd>Carries out stream IO along with the spatial and
temporal interpolation of the stream data to the model mesh and
model time. Initializes the module data type <code class="docutils literal notranslate"><span class="pre">shr_strdata_type</span></code>.</dd>
<dt><strong>dshr_stream_mod.F90</strong></dt>
<dd>Reads in the stream xml file and returns the upper and
lower bounds of the stream data. Initializes the module data type
<code class="docutils literal notranslate"><span class="pre">shr_stream_streamType</span></code>.</dd>
<dt><strong>dshr_tinterp_mod.F90</strong></dt>
<dd>Determines the time interpolation factors.</dd>
<dt><strong>dshr_methods_mod.F90</strong></dt>
<dd>Wrappers to ESMF such as getting a pointer to a field in a field bundle, etc.</dd>
</dl>
</div>
<div class="section" id="stream-datatypes">
<h2>3.6. Stream Datatypes<a class="headerlink" href="#stream-datatypes" title="Permalink to this headline">¶</a></h2>
<p>The most basic type, <code class="docutils literal notranslate"><span class="pre">shr_stream_fileType</span></code> is contained in
<code class="docutils literal notranslate"><span class="pre">shr_stream_mod.F90</span></code> and specifies basic information related to a
given stream file.</p>
<div class="highlight-Fortran notranslate"><div class="highlight"><pre><span></span><span class="k">type </span><span class="n">shr_stream_fileType</span>
   <span class="kt">character</span><span class="p">(</span><span class="n">SHR_KIND_CL</span><span class="p">)</span> <span class="kd">::</span> <span class="n">name</span> <span class="o">=</span> <span class="n">shr_stream_file_null</span>     <span class="c">! the file name</span>
   <span class="kt">logical</span>                <span class="kd">::</span> <span class="n">haveData</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>              <span class="c">! has t-coord data been read in?</span>
   <span class="kt">integer</span>  <span class="p">(</span><span class="n">SHR_KIND_IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nt</span> <span class="o">=</span> <span class="mi">0</span>                          <span class="c">! size of time dimension</span>
   <span class="kt">integer</span>  <span class="p">(</span><span class="n">SHR_KIND_IN</span><span class="p">),</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">date</span><span class="p">(:)</span>             <span class="c">! t-coord date: yyyymmdd</span>
   <span class="kt">integer</span>  <span class="p">(</span><span class="n">SHR_KIND_IN</span><span class="p">),</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">secs</span><span class="p">(:)</span>             <span class="c">! t-coord secs: elapsed on date</span>
<span class="k">end type </span><span class="n">shr_stream_fileType</span>
</pre></div>
</div>
<p>The following type, <code class="docutils literal notranslate"><span class="pre">shr_stream_streamType</span></code> contains information
that encapsulates the information related to all files specific to a
target stream. (see the overview of the <a class="reference internal" href="streams.html#stream-description-file"><span class="std std-ref">Data Model Stream XML Input</span></a>).</p>
<div class="highlight-Fortran notranslate"><div class="highlight"><pre><span></span><span class="k">type </span><span class="n">shr_stream_streamType</span>
   <span class="c">!private ! no public access to internal components</span>
   <span class="kt">integer</span>           <span class="kd">::</span> <span class="n">logunit</span>                               <span class="c">! stdout log unit</span>
   <span class="k">type</span><span class="p">(</span><span class="n">iosystem_desc_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">pio_subsystem</span>
   <span class="kt">integer</span>           <span class="kd">::</span> <span class="n">pio_iotype</span>
   <span class="kt">integer</span>           <span class="kd">::</span> <span class="n">pio_ioformat</span>
   <span class="kt">logical</span>           <span class="kd">::</span> <span class="n">init</span>         <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>                <span class="c">! has stream been initialized</span>
   <span class="kt">integer</span>           <span class="kd">::</span> <span class="n">nFiles</span>       <span class="o">=</span> <span class="mi">0</span>                      <span class="c">! number of data files</span>
   <span class="kt">integer</span>           <span class="kd">::</span> <span class="n">yearFirst</span>    <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>                     <span class="c">! first year to use in t-axis (yyyymmdd)</span>
   <span class="kt">integer</span>           <span class="kd">::</span> <span class="n">yearLast</span>     <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>                     <span class="c">! last  year to use in t-axis (yyyymmdd)</span>
   <span class="kt">integer</span>           <span class="kd">::</span> <span class="n">yearAlign</span>    <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>                     <span class="c">! align yearFirst with this model year</span>
   <span class="kt">character</span><span class="p">(</span><span class="n">CS</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">taxMode</span>      <span class="o">=</span> <span class="n">shr_stream_taxis_cycle</span> <span class="c">! cycling option for time axis</span>
   <span class="kt">character</span><span class="p">(</span><span class="n">CS</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">tInterpAlgo</span>  <span class="o">=</span> <span class="s1">&#39;linear&#39;</span>               <span class="c">! algorithm to use for time interpolation</span>
   <span class="kt">character</span><span class="p">(</span><span class="n">CS</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">mapalgo</span>      <span class="o">=</span> <span class="s1">&#39;bilinear&#39;</span>             <span class="c">! type of mapping - default is &#39;bilinear&#39;</span>
   <span class="kt">character</span><span class="p">(</span><span class="n">CS</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">readMode</span>     <span class="o">=</span> <span class="s1">&#39;single&#39;</span>               <span class="c">! stream read model - &#39;single&#39; or &#39;full_file&#39;</span>
   <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">dtlimit</span>      <span class="o">=</span> <span class="mf">1.5_r8</span>                 <span class="c">! delta time ratio limits for time interpolation</span>
   <span class="kt">integer</span>           <span class="kd">::</span> <span class="n">offset</span>       <span class="o">=</span> <span class="mi">0</span>                      <span class="c">! offset in seconds of stream data</span>
   <span class="kt">character</span><span class="p">(</span><span class="n">CS</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">calendar</span>     <span class="o">=</span> <span class="n">shr_cal_noleap</span>         <span class="c">! stream calendar (obtained from first stream data file)</span>
   <span class="kt">character</span><span class="p">(</span><span class="n">CL</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">meshFile</span>     <span class="o">=</span> <span class="s1">&#39; &#39;</span>                    <span class="c">! filename for mesh for all fields on stream (full pathname)</span>
   <span class="kt">integer</span>           <span class="kd">::</span> <span class="n">k_lvd</span>        <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>                     <span class="c">! file/sample of least valid date</span>
   <span class="kt">integer</span>           <span class="kd">::</span> <span class="n">n_lvd</span>        <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>                     <span class="c">! file/sample of least valid date</span>
   <span class="kt">logical</span>           <span class="kd">::</span> <span class="n">found_lvd</span>    <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>                <span class="c">! T &lt;=&gt; k_lvd,n_lvd have been set</span>
   <span class="kt">integer</span>           <span class="kd">::</span> <span class="n">k_gvd</span>        <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>                     <span class="c">! file/sample of greatest valid date</span>
   <span class="kt">integer</span>           <span class="kd">::</span> <span class="n">n_gvd</span>        <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>                     <span class="c">! file/sample of greatest valid date</span>
   <span class="kt">logical</span>           <span class="kd">::</span> <span class="n">found_gvd</span>    <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>                <span class="c">! T &lt;=&gt; k_gvd,n_gvd have been set</span>
   <span class="kt">logical</span>           <span class="kd">::</span> <span class="n">fileopen</span>     <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>                <span class="c">! is current file open</span>
   <span class="kt">character</span><span class="p">(</span><span class="n">CL</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">currfile</span>     <span class="o">=</span> <span class="s1">&#39; &#39;</span>                    <span class="c">! current filename</span>
   <span class="kt">integer</span>           <span class="kd">::</span> <span class="n">nvars</span>                                 <span class="c">! number of stream variables</span>
   <span class="kt">character</span><span class="p">(</span><span class="n">CL</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">stream_vectors</span>                        <span class="c">! stream vectors names</span>
   <span class="k">type</span><span class="p">(</span><span class="n">file_desc_t</span><span class="p">)</span> <span class="kd">::</span> <span class="n">currpioid</span>                             <span class="c">! current pio file desc</span>
   <span class="k">type</span><span class="p">(</span><span class="n">shr_stream_file_type</span><span class="p">)</span>    <span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="k">file</span><span class="p">(:)</span>     <span class="c">! filenames of stream data files (full pathname)</span>
   <span class="k">type</span><span class="p">(</span><span class="n">shr_stream_data_variable</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">varlist</span><span class="p">(:)</span>  <span class="c">! stream variable names (on file and in model)</span>
<span class="k">end type </span><span class="n">shr_stream_streamType</span>
</pre></div>
</div>
<p>Finally, the datatypes <code class="docutils literal notranslate"><span class="pre">shr_strdata_per_stream</span></code> and
<code class="docutils literal notranslate"><span class="pre">shr_strdata_type</span></code> in <code class="docutils literal notranslate"><span class="pre">dshr_strdata_mod.F90</span></code> are at the heart
of the CDEPS stream code and contains information for
all the streams that are active for the target data model.</p>
<div class="highlight-Fortran notranslate"><div class="highlight"><pre><span></span><span class="k">type </span><span class="n">shr_strdata_perstream</span>
   <span class="kt">character</span><span class="p">(</span><span class="n">CL</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">stream_meshfile</span>                 <span class="c">! stream mesh file from stream txt file</span>
   <span class="k">type</span><span class="p">(</span><span class="n">ESMF_Mesh</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">stream_mesh</span>                     <span class="c">! stream mesh created from stream mesh file</span>
   <span class="k">type</span><span class="p">(</span><span class="n">io_desc_t</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">stream_pio_iodesc</span>               <span class="c">! stream pio descriptor</span>
   <span class="kt">logical</span>                             <span class="kd">::</span> <span class="n">stream_pio_iodesc_set</span> <span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! true=&gt;pio iodesc has been set</span>
   <span class="k">type</span><span class="p">(</span><span class="n">ESMF_RouteHandle</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">routehandle</span>                     <span class="c">! stream n -&gt; model mesh mapping</span>
   <span class="kt">character</span><span class="p">(</span><span class="n">CL</span><span class="p">),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">fldlist_stream</span><span class="p">(:)</span>               <span class="c">! names of stream file fields</span>
   <span class="kt">character</span><span class="p">(</span><span class="n">CL</span><span class="p">),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">fldlist_model</span><span class="p">(:)</span>                <span class="c">! names of stream model fields</span>
   <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">stream_lb</span>                       <span class="c">! index of the Lowerbound (LB) in fldlist_stream</span>
   <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">stream_ub</span>                       <span class="c">! index of the Upperbound (UB) in fldlist_stream</span>
   <span class="k">type</span><span class="p">(</span><span class="n">ESMF_Field</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">field_stream</span>                    <span class="c">! a field on the stream data domain</span>
   <span class="k">type</span><span class="p">(</span><span class="n">ESMF_Field</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">stream_vector</span>                   <span class="c">! a vector field on the stream data domain</span>
   <span class="k">type</span><span class="p">(</span><span class="n">ESMF_FieldBundle</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">fldbun_data</span><span class="p">(:)</span>                  <span class="c">! stream field bundle interpolated to model grid</span>
   <span class="k">type</span><span class="p">(</span><span class="n">ESMF_FieldBundle</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">fldbun_model</span>                    <span class="c">! stream n field bundle interpolated to model grid and time</span>
   <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">ucomp</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>                      <span class="c">! index of vector u in stream</span>
   <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">vcomp</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>                      <span class="c">! index of vector v in stream</span>
   <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">ymdLB</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>                      <span class="c">! stream ymd lower bound</span>
   <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">todLB</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>                      <span class="c">! stream tod lower bound</span>
   <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">ymdUB</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>                      <span class="c">! stream ymd upper bound</span>
   <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">todUB</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>                      <span class="c">! stream tod upper bound</span>
   <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">)</span>                            <span class="kd">::</span> <span class="n">dtmin</span> <span class="o">=</span> <span class="mf">1.0e30_r8</span>
   <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">)</span>                            <span class="kd">::</span> <span class="n">dtmax</span> <span class="o">=</span> <span class="mf">0.0_r8</span>
   <span class="k">type</span><span class="p">(</span><span class="n">ESMF_Field</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">field_coszen</span>                    <span class="c">! needed for coszen time interp</span>
<span class="k">end type </span><span class="n">shr_strdata_perstream</span>
</pre></div>
</div>
<div class="highlight-Fortran notranslate"><div class="highlight"><pre><span></span><span class="k">type </span><span class="n">shr_strdata_type</span>
   <span class="k">type</span><span class="p">(</span><span class="n">shr_strdata_perstream</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">pstrm</span><span class="p">(:)</span>              <span class="c">! stream info</span>
   <span class="k">type</span><span class="p">(</span><span class="n">shr_stream_streamType</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">stream</span><span class="p">(:)</span><span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>        <span class="c">! stream datatype</span>
   <span class="kt">integer</span>                        <span class="kd">::</span> <span class="n">nvectors</span>                        <span class="c">! number of vectors</span>
   <span class="kt">logical</span>                        <span class="kd">::</span> <span class="n">masterproc</span>
   <span class="kt">integer</span>                        <span class="kd">::</span> <span class="n">logunit</span>                         <span class="c">! stdout unit</span>
   <span class="kt">integer</span>                        <span class="kd">::</span> <span class="n">io_type</span>                         <span class="c">! pio info</span>
   <span class="kt">integer</span>                        <span class="kd">::</span> <span class="n">io_format</span>                       <span class="c">! pio info</span>
   <span class="kt">integer</span>                        <span class="kd">::</span> <span class="n">modeldt</span> <span class="o">=</span> <span class="mi">0</span>                     <span class="c">! model dt in seconds</span>
   <span class="k">type</span><span class="p">(</span><span class="n">ESMF_Mesh</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">model_mesh</span>                      <span class="c">! model mesh</span>
   <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">pointer</span>              <span class="kd">::</span> <span class="n">model_lon</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>          <span class="c">! model longitudes</span>
   <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">pointer</span>              <span class="kd">::</span> <span class="n">model_lat</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>          <span class="c">! model latitudes</span>
   <span class="kt">integer</span>                        <span class="kd">::</span> <span class="n">model_nxg</span>                       <span class="c">! model global domain lon size</span>
   <span class="kt">integer</span>                        <span class="kd">::</span> <span class="n">model_nyg</span>                       <span class="c">! model global domain lat size</span>
   <span class="kt">integer</span>                        <span class="kd">::</span> <span class="n">model_nzg</span>                       <span class="c">! model global domain vertical size</span>
   <span class="kt">integer</span>                        <span class="kd">::</span> <span class="n">model_lsize</span>                     <span class="c">! model local domain size</span>
   <span class="kt">integer</span><span class="p">,</span> <span class="k">pointer</span>               <span class="kd">::</span> <span class="n">model_gindex</span><span class="p">(:)</span>                 <span class="c">! model global index spzce</span>
   <span class="kt">integer</span>                        <span class="kd">::</span> <span class="n">model_gsize</span>                     <span class="c">! model global domain size</span>
   <span class="k">type</span><span class="p">(</span><span class="n">ESMF_CLock</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">model_clock</span>                     <span class="c">! model clock</span>
   <span class="kt">character</span><span class="p">(</span><span class="n">CL</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">model_calendar</span> <span class="o">=</span> <span class="n">shr_cal_noleap</span> <span class="c">! model calendar for ymd,tod</span>
   <span class="kt">integer</span>                        <span class="kd">::</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">tod</span>                        <span class="c">! model time</span>
   <span class="k">type</span><span class="p">(</span><span class="n">iosystem_desc_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">pio_subsystem</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>         <span class="c">! pio info</span>
   <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">eccen</span>  <span class="o">=</span> <span class="n">SHR_ORB_UNDEF_REAL</span>     <span class="c">! cosz t-interp info</span>
   <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">mvelpp</span> <span class="o">=</span> <span class="n">SHR_ORB_UNDEF_REAL</span>     <span class="c">! cosz t-interp info</span>
   <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">lambm0</span> <span class="o">=</span> <span class="n">SHR_ORB_UNDEF_REAL</span>     <span class="c">! cosz t-interp info</span>
   <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">obliqr</span> <span class="o">=</span> <span class="n">SHR_ORB_UNDEF_REAL</span>     <span class="c">! cosz t-interp info</span>
   <span class="kt">real</span><span class="p">(</span><span class="n">r8</span><span class="p">),</span> <span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">tavCoszen</span><span class="p">(:)</span>                    <span class="c">! cosz t-interp data</span>
<span class="k">end type </span><span class="n">shr_strdata_type</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="streams.html" class="btn btn-neutral" title="2. Input Streams" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, U.S. National Science Foundation.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
     
<script>var version_json_loc = "../../versions.json";</script>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'master',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>
      <script type="text/javascript" src="_static/pop_ver.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>